(this.webpackJsonppwa_weather_app=this.webpackJsonppwa_weather_app||[]).push([[0],{13:function(e,t,a){e.exports=a(37)},36:function(e,t,a){},37:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(11),l=a.n(r),o=a(12),i=a.n(o);const s="https://api.weatherapi.com/v1/current.json?aqi=no",m="69f028e3aab242eaa67170122231510";a(35),a(36);const u=e=>{switch(e){case"Sunny":return"/images/weather/sunny.png";case"Cloudy":return"/images/weather/cloudy.png";case"Partly cloudy":return"/images/weather/partly_cloudy.png";case"Mist":return"/images/weather/mist.png";default:return"/images/weather/sunny.png"}};var p=()=>{const[e,t]=Object(n.useState)(""),[a,r]=Object(n.useState)({}),[l,o]=Object(n.useState)([]),[p,h]=Object(n.useState)(!navigator.onLine),[w,g]=Object(n.useState)(!1),[d,E]=Object(n.useState)(u()),f=()=>{h(!navigator.onLine)};Object(n.useEffect)(()=>{window.addEventListener("online",f),window.addEventListener("offline",f);const e=JSON.parse(localStorage.getItem("recentCities"))||[];return o(e),()=>{window.removeEventListener("online",f),window.removeEventListener("offline",f)}},[]);const y=async e=>{g(!1);try{const a=await(async e=>{try{const{data:t}=await i.a.get(s,{params:{q:e,key:m}});return t}catch(t){if(navigator.onLine)throw t;{const t=await caches.open("data-cache-v1"),a="".concat(s,"?q=").concat(e,"&key=").concat(m);let n=await t.match(a);if(!n||!n.ok){const e=(await t.keys()).filter(e=>e.url.includes("weatherapi.com"));if(e.length>0){const a=e[e.length-1];n=await t.match(a)}}if(n&&n.ok)return await n.json();throw new Error("Offline and no cached data available")}}})(e);r(a),(e=>{o(t=>{const a=[e,...t.filter(t=>t!==e)];return a.length>5&&a.pop(),localStorage.setItem("recentCities",JSON.stringify(a)),a})})(a.location.name),t(a.location.name),E(u(a.current.condition.text))}catch(a){g(!0),console.error("Failed to fetch weather",a)}};return c.a.createElement("div",{className:"wrapper"},c.a.createElement("img",{className:"bg-image",src:d,alt:"weather image"}),c.a.createElement("div",{className:"main-container"},c.a.createElement("div",{className:"form-wrapper"},c.a.createElement("form",{className:"form",onSubmit:async t=>{t.preventDefault(),await y(e)},action:"",autoComplete:"on"},c.a.createElement("input",{autoComplete:"on",type:"text",name:"city",className:"search-input ".concat(w?"input-error":""),placeholder:"Type city name...",value:e,onChange:e=>(e=>{t(e),g(!1)})(e.target.value)}),c.a.createElement("button",{type:"submit"},"go")),w&&c.a.createElement("p",{className:"form-error"},"Wrong city name")),p&&c.a.createElement("div",{className:"offline-message"},"You're currently offline, showing last cached results."),a.location&&c.a.createElement("article",{className:"weather-result"},c.a.createElement("header",{className:"weather-location"},c.a.createElement("h2",{className:"weather-location-city"},a.location.name),c.a.createElement("p",{className:"weather-location-country"},a.location.country)),c.a.createElement("section",{className:"weather-temp"},c.a.createElement("h3",null,"temp: ",c.a.createElement("strong",null,Math.round(a.current.temp_c),c.a.createElement("sup",null,"\xb0C"))),c.a.createElement("h3",null,"feels like: ",c.a.createElement("strong",null,Math.round(a.current.temp_c),c.a.createElement("sup",null,"\xb0C")))),c.a.createElement("section",{className:"weather-info"},c.a.createElement("figure",null,c.a.createElement("img",{className:"weather-icon",src:a.current.condition.icon,alt:"Weather icon"}),c.a.createElement("figcaption",null,a.current.condition.text)))),l.length>0&&c.a.createElement("div",{className:"recent-cities"},c.a.createElement("ul",null,l.map(a=>a!==e?c.a.createElement("li",{onClick:()=>(async e=>{t(e),await y(e)})(a),key:a},a):null)))))};l.a.render(c.a.createElement(p,null),document.getElementById("root"))}},[[13,1,2]]]);
//# sourceMappingURL=main.0465f783.chunk.js.map